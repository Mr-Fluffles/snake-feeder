<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Danger Noodle Tracker</title>
    <style>
        :root {
            --bg: #C8E6C9; /* Default Pastel Mint */
            --card: #1e1e1e;
            --text: #e0e0e0;
            --accent: #00e676;
            --danger: #ff5252;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--bg);
            color: var(--text);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            margin: 0;
            text-align: center;
            transition: background-color 0.5s ease;
            overflow-x: hidden;
        }
        .container {
            background: var(--card);
            padding: 2rem;
            border-radius: 20px;
            width: 85%;
            max-width: 400px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2); /* Softer shadow */
            position: relative;
            z-index: 10;
            transition: transform 1s;
        }
        h1 { margin-top: 0; font-size: 1.8rem; }
        .emoji { font-size: 3rem; display: block; margin-bottom: 10px; }
        
        .input-group { margin: 15px 0; font-size: 1.1rem; }
        
        .status {
            font-size: 1.2rem;
            margin: 20px 0;
            padding: 15px;
            background: #333;
            border-radius: 10px;
            font-weight: bold;
        }
        button {
            background: var(--accent);
            color: #000;
            border: none;
            padding: 15px 30px;
            font-size: 1.2rem;
            font-weight: bold;
            border-radius: 50px;
            cursor: pointer;
            width: 100%;
            margin-top: 10px;
            transition: transform 0.1s;
        }
        button:active { transform: scale(0.95); }
        button.secondary {
            background: transparent;
            border: 2px solid var(--accent);
            color: var(--accent);
            margin-top: 20px;
        }
        input[type="number"] {
            background: #333;
            border: none;
            color: white;
            padding: 10px;
            border-radius: 5px;
            width: 60px;
            text-align: center;
            font-size: 1rem;
            font-weight: bold;
        }
        
        /* --- PASTEL PICKER UI --- */
        .theme-label {
            margin-top: 30px;
            font-size: 0.9rem;
            color: #888;
            margin-bottom: 10px;
            display: block;
        }
        .pastel-swatches {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 15px;
        }
        .swatch {
            width: 35px;
            height: 35px;
            border-radius: 50%;
            cursor: pointer;
            border: 2px solid transparent;
            transition: transform 0.2s;
        }
        .swatch:hover { transform: scale(1.1); }
        
        /* Hide the ugly default picker but keep it functional */
        .manual-picker-wrapper {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 5px;
            font-size: 0.8rem;
            color: #666;
        }
        input[type="color"] {
            border: none;
            width: 30px;
            height: 30px;
            cursor: pointer;
            background: none;
            border-radius: 50%;
        }
        
        /* --- THE STEALTH TRAP --- */
        .forbidden-btn {
            background-color: #2a0000;
            color: #5e0000;
            font-size: 0.7rem;
            padding: 8px;
            margin-top: 50px;
            border: 1px solid #3d0000;
            border-radius: 5px;
            opacity: 0;
            animation: creepIn 3s forwards;
            animation-delay: 5s;
            cursor: help;
        }
        
        @keyframes creepIn {
            from { opacity: 0; }
            to { opacity: 0.3; }
        }

        /* CHAOS MODE STYLES */
        body.chaos {
            background-image: url('https://media.giphy.com/media/M7gtacN7aPNsc/giphy.gif');
            background-size: cover;
            background-repeat: no-repeat;
            background-position: center;
            animation: rainbow-flash 0.2s infinite;
        }
        .container.chaos-spin {
            animation: spin 3s infinite linear;
            border: 5px solid hotpink;
        }
        @keyframes rainbow-flash {
            0% { filter: hue-rotate(0deg); }
            100% { filter: hue-rotate(360deg); }
        }
        @keyframes spin {
            100% { transform: rotate(360deg); }
        }

        .small-text { font-size: 0.8rem; color: #888; margin-top: 10px;}
    </style>
</head>
<body>

<div class="container" id="mainCard">
    <span class="emoji">üêç</span>
    <h1 id="titleText">Danger Noodle Tracker</h1>
    
    <div class="input-group">
        Feed every <input type="number" id="interval" value="21"> days
    </div>

    <div class="status" id="statusDisplay">
        Loading...
    </div>

    <button onclick="feedSnake()">I Fed The Snek!</button>
    
    <button class="secondary" onclick="addToCalendar()">üìÖ Recurring Reminder</button>

    <p class="small-text" id="lastFedText"></p>

    <span class="theme-label">Choose a Vibe:</span>
    <div class="pastel-swatches">
        <div class="swatch" style="background: #C8E6C9;" onclick="setTheme('#C8E6C9')"></div>
        <div class="swatch" style="background: #E1BEE7;" onclick="setTheme('#E1BEE7')"></div>
        <div class="swatch" style="background: #B3E5FC;" onclick="setTheme('#B3E5FC')"></div>
        <div class="swatch" style="background: #FFCCBC;" onclick="setTheme('#FFCCBC')"></div>
        <div class="swatch" style="background: #F8BBD0;" onclick="setTheme('#F8BBD0')"></div>
    </div>

    <div class="manual-picker-wrapper">
        or custom: <input type="color" id="bgPicker" value="#C8E6C9">
    </div>

    <button class="forbidden-btn" onclick="activateChaos()">üö´ DO NOT PRESS</button>
</div>

<script>
    // --- Standard Logic ---
    const savedDate = localStorage.getItem('lastFed');
    const savedInterval = localStorage.getItem('interval');
    const savedColor = localStorage.getItem('themeColor');

    if (savedInterval) document.getElementById('interval').value = savedInterval;
    
    // Load saved color or default to Mint
    const initialColor = savedColor || '#C8E6C9';
    setTheme(initialColor, false); // false = don't save yet (avoid loop)

    updateDisplay();

    // Manual Picker Listener
    document.getElementById('bgPicker').addEventListener('input', function(e) {
        setTheme(e.target.value);
    });

    // Theme Setter Function
    function setTheme(color, save = true) {
        document.documentElement.style.setProperty('--bg', color);
        document.getElementById('bgPicker').value = color;
        if (save) {
            localStorage.setItem('themeColor', color);
        }
    }

    function feedSnake() {
        const now = new Date();
        localStorage.setItem('lastFed', now.toISOString());
        localStorage.setItem('interval', document.getElementById('interval').value);
        updateDisplay();
    }

    function updateDisplay() {
        const lastFed = localStorage.getItem('lastFed');
        const interval = parseInt(document.getElementById('interval').value) || 21;
        const statusDiv = document.getElementById('statusDisplay');
        const lastFedText = document.getElementById('lastFedText');

        if (!lastFed) {
            statusDiv.innerHTML = "‚ö†Ô∏è No data. Feed the noodle!";
            statusDiv.style.color = "var(--danger)";
            return;
        }

        const lastDate = new Date(lastFed);
        const nextDate = new Date(lastDate);
        nextDate.setDate(lastDate.getDate() + interval);
        const today = new Date();
        today.setHours(0,0,0,0);
        nextDate.setHours(0,0,0,0);
        const diffTime = nextDate - today;
        const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
        lastFedText.innerText = "Last fed: " + lastDate.toLocaleDateString();
        if (diffDays <= 0) {
            statusDiv.innerHTML = "üçΩÔ∏è FEED ME NOW!";
            statusDiv.style.color = "var(--danger)";
        } else {
            statusDiv.innerHTML = `Next feed in <b>${diffDays} days</b>`;
            statusDiv.style.color = "var(--accent)";
        }
    }

    function addToCalendar() {
        const interval = parseInt(document.getElementById('interval').value) || 21;
        const lastFed = localStorage.getItem('lastFed') ? new Date(localStorage.getItem('lastFed')) : new Date();
        const nextFeed = new Date(lastFed);
        nextFeed.setDate(nextFeed.getDate() + interval);
        const year = nextFeed.getFullYear();
        const month = (nextFeed.getMonth() + 1).toString().padStart(2, '0');
        const day = nextFeed.getDate().toString().padStart(2, '0');
        const dateString = `${year}${month}${day}`;

        const icsMsg = `BEGIN:VCALENDAR
VERSION:2.0
BEGIN:VEVENT
DTSTART;VALUE=DATE:${dateString}
RRULE:FREQ=DAILY;INTERVAL=${interval}
SUMMARY:üêç Feed the Danger Noodle
DESCRIPTION:Repeats every ${interval} days.
BEGIN:VALARM
TRIGGER:-PT9H
ACTION:DISPLAY
DESCRIPTION:Reminder
END:VALARM
END:VEVENT
END:VCALENDAR`;

        const blob = new Blob([icsMsg], { type: 'text/calendar' });
        const url = window.URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = 'snek-schedule.ics';
        document.body.appendChild(a);
        a.click();
        window.URL.revokeObjectURL(url);
        document.body.removeChild(a);
    }

    // --- CHAOS MODE LOGIC ---
    let chaosAudio = null; 

    function activateChaos() {
        if(!confirm("WARNING: Do not press this. Seriously.")) {
            return; 
        }
        
        document.body.classList.add('chaos'); 
        document.getElementById('mainCard').classList.add('chaos-spin');
        document.getElementById('titleText').innerText = "HEYYEYAAEYAAAEYAEYAA";
        document.querySelector('.forbidden-btn').style.display = 'none';
        
        // Tries to play 'heman.mp3' - Ensure this file is in your GitHub repo!
        chaosAudio = new Audio('heman.mp3');
        chaosAudio.loop = true; 
        chaosAudio.volume = 1.0; 
        
        chaosAudio.play().catch(e => console.log("Audio failed (iOS requires interaction or silent switch off): " + e));
        
        setTimeout(() => {
            alert("ü¶Ñ TURN UP YOUR VOLUME! ü¶Ñ\n(Refresh the app to survive)");
        }, 500);
    }
</script>

</body>
</html>
